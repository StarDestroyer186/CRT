var map,
  ext,
  once = [],
  current_id = 0,
  menu_operator_id = 0,
  timer,
  remain = 20,
  needloc = !1,
  zones = [],
  usermarkers = [],
  geoList = null,
  needLoadCommand = !0,
  needUpdatePlace = !1,
  needUpdateUser = !0,
  nologin = !1,
  firstClick = !0,
  lastLat = null,
  lastLng = null,
  queryingAlarm = !1,
  queryingMilEng = !1,
  queryingDriver = !1,
  queryingPhoto = !1,
  queryingMaTa = !1,
  fastHistoryValue = null,
  blockMoroccoBorders = !1,
  iconSelect,
  lastAlarmId = 0,
  requestTimeout = 6e4,
  needShowAllAsset = 0,
  UNIT_SPEED,
  UNIT_DIST,
  UNIT_FUEL,
  UNIT_TEMP,
  UNIT_ALTITUDE,
  UNIT_HUMIDITY,
  UNIT_TPMS,
  exportFileName = "",
  exportTableId = "",
  reportHeader = "",
  array_users,
  objLastEvent = [],
  objLastMiEg = [],
  objLastDriver = [],
  objLastPhoto = [],
  objLastMaTa = [],
  ANIMATION_TIME = 2e3,
  OffsetH = 62,
  OffsetW = 14,
  typeCmd,
  protocolCmd;
function checkTabbarScrollbar() {
  $(".tabbar").hasScrollBar("horizontal")
    ? $(".tablist").css("top", "39px")
    : $(".tablist").css("top", "22px");
}
function returnUser() {
  var e = (new Date().getTimezoneOffset() / 60) * -1;
  showLoading(!0);
  var t = setTimeout("showLoading(false,true)", requestTimeout);
  try {
    $.post(
      "login.ajax.php?t=" + new Date().getTime(),
      { type: 0, timezone: e },
      function (e) {
        clearTimeout(t),
          showLoading(!1),
          e.indexOf("ok") >= 0 && window.parent.location.reload(!0);
      }
    );
  } catch (e) {
    error(showLoading(!1));
  }
}
function initUnits() {
  (UNIT_SPEED = "kph"),
    1 == JS_UNIT_SPEED && (UNIT_SPEED = "mph"),
    (UNIT_DIST = "km"),
    1 == JS_UNIT_DISTANCE
      ? (UNIT_DIST = "mi")
      : 2 == JS_UNIT_DISTANCE && (UNIT_DIST = "nmi"),
    (UNIT_FUEL = "L"),
    1 == JS_UNIT_FUEL && (UNIT_FUEL = "gal"),
    (UNIT_TEMP = "℃"),
    1 == JS_UNIT_TEMPERATURE && (UNIT_TEMP = "℉"),
    (UNIT_ALTITUDE = "m"),
    1 == JS_UNIT_ALTITUDE && (UNIT_ALTITUDE = "ft"),
    (UNIT_HUMIDITY = "%rh"),
    JS_UNIT_HUMIDITY,
    (UNIT_TPMS = "bar"),
    1 == JS_UNIT_TPMS
      ? (UNIT_TPMS = "kpa")
      : 2 == JS_UNIT_TPMS
      ? (UNIT_TPMS = "psi")
      : 3 == JS_UNIT_TPMS && (UNIT_TPMS = "kg/cm2");
}
function getIcons() {
  for (var e = [], t = 1; t <= JS_OBJECT_KIND; t++)
    e.push({ iconFilePath: "img/icons/icon_" + t + ".svg", iconValue: t });
  return e;
}
function getDeviceListData(start) {
  $.get(
    "devlist.ajax.php",
    { start: start, userName: $("#user a").text() },
    function (data) {
      if ("" != $.trim(data)) {
        var result = eval("(" + data + ")");
        if (
          (null != result &&
            void 0 !== result &&
            (refresh_list(result),
            updateDevice(result.data, current_id, map, result.first)),
          result.start > -1)
        )
          getDeviceListData(result.start);
        else {
          cancelDefShowAll(),
            $("#selone").bind("click", search_select),
            $("#showobjchart").bind("click", showObjChart),
            $("#speedcompass #close").click(function () {
              $("#speedcompass .content").toggle(),
                $("#speedcompass .content").is(":visible")
                  ? ($("#speedcompass")
                      .removeClass("speedcompasshide")
                      .addClass("speedcompassshow"),
                    $("#speedcompass #close")
                      .removeClass("speedchart_max")
                      .addClass("speedchart_min"))
                  : ($("#speedcompass")
                      .removeClass("speedcompassshow")
                      .addClass("speedcompasshide"),
                    $("#speedcompass #close")
                      .removeClass("speedchart_min")
                      .addClass("speedchart_max"));
            }),
            $("#device").keyup(function (e) {
              "13" == e.keyCode && (search_select(), e.preventDefault());
            });
          try {
            1 == JS_DEFAULT_FIT && map.MarkersFitBounds();
          } catch (e) {}
          $("#loadmapwait").css("display", "none"),
            (timer = setTimeout("relocate()", 1e3)),
            checkTabbarScrollbar();
        }
      }
    }
  );
}
function refresh_list(e) {
  var t = void 0 === map;
  if (
    (!t && e.first && map.ClearMarkers(),
    e.first &&
      (clearArray(JS_DEVICE_ID4FLAG),
      clearArray(JS_DEVICE_FLAG4ID),
      clearArray(JS_DEVICE_STATUS),
      clearArray(JS_DEVICE_TYPE4ID),
      clearArray(JS_DEVICE_SIM4ID),
      clearArray(JS_DEVICE_NO4ID),
      clearArray(JSDEVICE_DRIVER4ID),
      clearArray(JS_DEVICE_ID4GROUPID),
      clearArray(JS_GROUP),
      clearArray(JS_DEVICE_ID4IO)),
    void 0 !== e.data && null != e.data)
  )
    for (var o = 0; o < e.data.length; o++)
      for (var a = 0; a < e.data[o].item.length; a++) {
        var s = e.data[o].item[a];
        if (
          ((JS_DEVICE_ID4FLAG[s.c] = s.n),
          (JS_DEVICE_FLAG4ID[s.n] = s.c),
          (JS_DEVICE_STATUS[s.n] = s.e),
          (JS_DEVICE_ID4IO[s.n] = s.io),
          (JS_DEVICE_TYPE4ID[s.n] = s.dt),
          (JS_DEVICE_SIM4ID[s.n] = s.si),
          (JS_DEVICE_NO4ID[s.n] = s.nc),
          (JS_DEVICE_ID4GROUPID[s.n] = e.data[o].gid),
          null != s.dn && s.dn.length > 0 && (JSDEVICE_DRIVER4ID[s.n] = s.dn),
          t)
        ) {
          var d = getSpeedState(s.on, s.v, s.s, s.t, s.a, s.ar),
            l = {
              n: s.n,
              c: s.c,
              v: s.v,
              x: s.x,
              y: s.y,
              t:
                null == s.t || 0 == s.t.length
                  ? s.t
                  : $.format.date(s.t, JS_DEFAULT_DATETIME_fmt_JS),
              ts:
                null == s.ts || 0 == s.ts.length
                  ? s.ts
                  : $.format.date(s.ts, JS_DEFAULT_DATETIME_fmt_JS),
              i: s.i,
              d: s.d,
              a: s.a,
              sta: d.sta,
              spd: d.spd,
              st: s.st,
              io: s.io,
              dt: s.dt,
              s: d.val,
              jb: s.jb,
              dn: s.dn,
            };
          once.push(l);
        }
      }
  if (void 0 !== e.deleteo && null != e.deleteo)
    for (o = 0; o < e.deleteo.length; o++) {
      var i = e.deleteo[o],
        r = JS_DEVICE_ID4GROUPID[i];
      deleteObject(r, i);
    }
  if (void 0 !== e.deleteg && null != e.deleteg)
    for (o = 0; o < e.deleteg.length; o++) {
      r = e.deleteg[o];
      deleteGroup(r);
    }
  if (null != e.start && -1 == e.start)
    if ("1" == $("#asset_list_item").val()) {
      var p = getDeviceList();
      $("#device")
        .focus(function () {
          $(this).autocomplete("search", $(this).val());
        })
        .autocomplete({
          source: p,
          minLength: p.length < 2e3 ? 0 : 2,
          max: 10,
          scroll: !0,
          delay: 0,
        });
    } else if ("2" == $("#asset_list_item").val()) {
      p = getIDsList();
      $("#device")
        .focus(function () {
          $(this).autocomplete("search", $(this).val());
        })
        .autocomplete({
          source: p,
          minLength: p.length < 2e3 ? 0 : 2,
          max: 10,
          scroll: !0,
          delay: 0,
        });
    } else if ("3" == $("#asset_list_item").val()) {
      p = getSimList();
      $("#device")
        .focus(function () {
          $(this).autocomplete("search", $(this).val());
        })
        .autocomplete({
          source: p,
          minLength: p.length < 2e3 ? 0 : 2,
          max: 10,
          scroll: !0,
          delay: 0,
        });
    } else if ("4" == $("#asset_list_item").val()) {
      p = getDriverList();
      $("#device")
        .focus(function () {
          $(this).autocomplete("search", $(this).val());
        })
        .autocomplete({
          source: p,
          minLength: p.length < 2e3 ? 0 : 2,
          max: 10,
          scroll: !0,
          delay: 0,
        });
    } else {
      p = getGroupList();
      $("#device")
        .focus(function () {
          $(this).autocomplete("search", $(this).val());
        })
        .autocomplete({
          source: p,
          minLength: p.length < 2e3 ? 0 : 2,
          max: 10,
          scroll: !0,
          delay: 0,
        });
    }
}
function menuselect(e, t, o) {
  switch (e) {
    case 1:
      showTrackInfo(t);
      break;
    case 2:
      showDeviceInfo(t);
      break;
    case 3:
      showSendCmd(t);
      break;
    case 4:
      showAlarmInfo(t);
      break;
    case 5:
      showLastPhoto(t);
      break;
    case 6:
      showLastVoice(t);
      break;
    case 7:
      showSharePositionInfo(t);
  }
}
function initserach(e) {
  $("#asset_list_item").val("1");
  var t = getFlagById(e);
  $("#sch #device").val() != t && ($("#sch #device").val(t), search_select());
}
function map_locate(e, t, o, a, s) {
  var d = getFlagById(e),
    l = $("#geo #dev_flag");
  if ((l.text() != d && l.text(d), e > 0 && void 0 !== map)) {
    firstClick && $("#staswitch").click();
    var i = map.LocateMarker(e, t, s, !0);
    if (null == i || void 0 === i.properties || null == i.properties)
      return void $("#assetinfo #statuslist").empty();
    if (o || (a && current_id == e)) {
      var r = $("#assetinfo #statuslist").position().left,
        p = $("#addresslast").text();
      $("#assetinfo #statuslist").empty();
      var n = $("<tbody></tbody>").appendTo($("#assetinfo #statuslist")),
        c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_ASSET_NAME)
        .addClass("oneline info_name")
        .appendTo(c),
        $("<td align='right'></td>")
          .text(i.properties.title)
          .addClass("oneline info_right")
          .css({
            background:
              "url(img/icons/icon_" +
              i.properties.ico +
              ".svg) no-repeat 5px center",
            "padding-left": "30px",
            "background-size": "20px 20px",
          })
          .appendTo(c);
      c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_POSITION)
        .addClass("oneline info_position")
        .appendTo(c),
        $("<td align='right'></td>")
          .addClass("oneline info_right")
          .html(
            "<a target='_blank' href=" +
              JS_GOOGLE_MAP_BASE_LINK +
              "/maps?hl=en&q=" +
              (i.properties.y / 1e6).toFixed(5) +
              "," +
              (i.properties.x / 1e6).toFixed(5) +
              ">" +
              (i.properties.y / 1e6).toFixed(5) +
              " &#176;," +
              (i.properties.x / 1e6).toFixed(5) +
              " &#176;</a>"
          )
          .appendTo(c);
      c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_SPEED)
        .addClass("oneline info_speed")
        .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .text(i.properties.s + " " + UNIT_SPEED)
          .appendTo(c);
      c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_HEADING)
        .addClass("oneline info_angle")
        .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .html(i.properties.dir + " &#176;")
          .appendTo(c);
      c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_GPS_TIME)
        .addClass("oneline info_time")
        .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .html(i.properties.t)
          .appendTo(c);
      c = $("<tr></tr>").appendTo(n);
      $(
        "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
      )
        .text(JS_SERVER_TIME)
        .addClass("oneline info_time")
        .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .html(i.properties.ts)
          .appendTo(c);
      var _ = "---",
        m = "---";
      null != i.properties.st &&
        void 0 !== i.properties.st &&
        i.properties.st.length > 0 &&
        (i.properties.st.indexOf("3005") >= 0
          ? (_ = JS_ON)
          : i.properties.st.indexOf("3006") >= 0 && (_ = JS_OFF)),
        null != i.properties.dn &&
          void 0 !== i.properties.dn &&
          i.properties.dn.length > 0 &&
          (m = i.properties.dn),
        (c = $("#assetinfo #statuslist tr:eq(0)")),
        $(
          "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
        )
          .text(JS_ENGINE)
          .addClass("oneline info_engine")
          .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .html(_)
          .appendTo(c),
        (c = $("#assetinfo #statuslist tr:eq(1)")),
        $(
          "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
        )
          .text(JS_DRIVER_NAME)
          .addClass("oneline info_driver")
          .appendTo(c),
        $(
          "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        )
          .addClass("oneline")
          .html(m)
          .appendTo(c),
        (c = $("#assetinfo #statuslist tr:eq(2)")),
        $(
          "<td rowspan='4' valign='top' style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
        )
          .text(JS_ADDRESS)
          .addClass("oneline info_address")
          .appendTo(c);
      var f = $(
          "<td rowspan='4' align='right' valign='top' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
        ).appendTo(c),
        b = $(
          "<div id='addresslast' style='height: 68px; width: 100px; overflow-y: scroll;'></div>"
        ).appendTo(f);
      void 0 !== o &&
        o &&
        ($("#assetinfo").is(":hidden") ||
          (0 != lastLat &&
          0 != lastLng &&
          lastLat == i.properties.y &&
          lastLng == i.properties.x &&
          null != p &&
          p.length > 0
            ? b.text(p)
            : ((lastLat = i.properties.y),
              (lastLng = i.properties.x),
              b.addClass("query_waiting"),
              map.GeoNames(i.properties.x, i.properties.y, b, "text", 0))),
        $("#maptools #ed_street_view").hasClass("tool_active")
          ? ($("#maptools #ed_street_view")
              .attr("x", i.properties.x)
              .attr("y", i.properties.y)
              .attr("dir", i.properties.dir),
            $("#streetview_img").html(
              "<img src=https://maps.googleapis.com/maps/api/streetview?key=" +
                JS_GOOGLE_KEY +
                "&size=308x170&sensor=false&location=" +
                i.properties.y / 1e6 +
                "," +
                i.properties.x / 1e6 +
                "&fov=90&heading=" +
                i.properties.dir +
                "&pitch=10>"
            ))
          : $("#maptools #ed_street_view")
              .removeAttr("x")
              .removeAttr("y")
              .removeAttr("dir"));
      var g = getStatusById(e).split(";").reverse();
      if (g.length > 0)
        for (var h = 0, u = 0; u < g.length; u++)
          if (g[u].length > 0)
            for (
              var x = g[u].split("<br>"), v = i.properties.io, T = 0;
              T < x.length;
              T++
            ) {
              var y = x[T].split(": ");
              if (2 == y.length) {
                var E, C, w;
                (h = T % 6),
                  (c =
                    T == x.length - 1
                      ? $("#assetinfo #statuslist tr:eq(0)")
                      : $("#assetinfo #statuslist tr:eq(" + h + ")"));
                var S = getIdByIndex(v, T);
                if (T == x.length - 1) {
                  var I = $(
                    "<td rowspan='6' valign='top' style='border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff';></td>"
                  ).appendTo(c);
                  (E = $("<table style='margin: -3px 0px 0px 0px'></table>")
                    .addClass("tab_status")
                    .appendTo(I)),
                    (C = $("<tr></tr>").appendTo(E)),
                    (w = $(
                      "<td style='padding-left: 18px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
                    )
                      .addClass("info_status")
                      .text(y[0])
                      .appendTo(C));
                } else {
                  var k = $(
                    "<td style='padding-left: 20px; border-left: 10px solid #fff; border-right: 0px solid;'></td>"
                  )
                    .text(y[0])
                    .addClass("oneline")
                    .appendTo(c);
                  1 == S || 110 == S || 111 == S || 112 == S || 113 == S
                    ? k.addClass("info_io_battery")
                    : 2 == S
                    ? k.addClass("info_io_door")
                    : 4 == S
                    ? k.addClass("info_io_power")
                    : 5 == S || 6 == S || 7 == S || 8 == S || 104 == S
                    ? k.addClass("info_io_status")
                    : 22 == S
                    ? k.addClass("info_io_mode")
                    : 30 == S || 31 == S || 40 == S || 41 == S || 80 == S
                    ? k.addClass("info_io_fuel")
                    : 17 == S ||
                      18 == S ||
                      19 == S ||
                      61 == S ||
                      62 == S ||
                      64 == S ||
                      65 == S
                    ? k.addClass("info_io_time")
                    : 10 == S || 63 == S
                    ? k.addClass("info_io_odometer")
                    : 11 == S || 12 == S || 14 == S || 15 == S || 16 == S
                    ? k.addClass("info_io_nearest_zone")
                    : 13 == S
                    ? k.addClass("info_io_maintenance")
                    : 20 == S
                    ? k.addClass("info_io_gps")
                    : 21 == S
                    ? k.addClass("info_io_gsm")
                    : 23 == S || 50 == S || 51 == S
                    ? k.addClass("info_io_ad")
                    : 25 == S || 26 == S
                    ? k.addClass("info_io_command")
                    : 27 == S
                    ? k.addClass("info_io_altitude")
                    : 28 == S
                    ? k.addClass("info_io_passenger")
                    : 29 == S || 120 == S || 121 == S || 122 == S
                    ? k.addClass("info_io_humidity")
                    : 60 == S
                    ? k.addClass("info_io_max_speed")
                    : 72 == S ||
                      73 == S ||
                      74 == S ||
                      75 == S ||
                      76 == S ||
                      77 == S ||
                      78 == S ||
                      79 == S
                    ? k.addClass("info_io_temp")
                    : 95 == S
                    ? k.addClass("info_io_workid")
                    : 96 == S
                    ? k.addClass("info_io_driver_tel")
                    : 90 == S || 91 == S || 92 == S || 93 == S
                    ? k.addClass("info_io_task")
                    : 98 == S
                    ? k.addClass("info_io_pos_type")
                    : 99 == S
                    ? k.addClass("info_io_weight")
                    : 140 == S || 141 == S || 142 == S || 143 == S || 144 == S
                    ? k.addClass("info_io_digital")
                    : 197 == S || 198 == S || 199 == S || 200 == S
                    ? k.addClass("info_io_cell")
                    : 240 == S
                    ? k.addClass("info_io_moving")
                    : 100 == S
                    ? k.addClass("info_alarm_name")
                    : 69 == S
                    ? k.addClass("info_io_acc")
                    : 81 == S
                    ? k.addClass("info_io_tire")
                    : 241 == S
                    ? k.addClass("info_io_sleep_mode")
                    : 242 == S
                    ? k.addClass("info_io_gnns_status")
                    : 245 == S
                    ? k.addClass("info_io_seat_belt")
                    : 246 == S
                    ? k.addClass("info_io_route_length")
                    : 247 == S
                    ? k.addClass("info_io_moving_percent")
                    : 248 == S
                    ? k.addClass("info_io_departure")
                    : 249 == S
                    ? k.addClass("info_io_delivery")
                    : 290 == S || 293 == S
                    ? k.addClass("info_io_dist_to_leader")
                    : 291 == S || 292 == S
                    ? k.addClass("info_io_time_to_leader")
                    : k.addClass("info_io");
                }
                if (
                  null !=
                  (null != y[1] &&
                    y[1].match(
                      /^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/
                    ))
                )
                  $(
                    "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
                  )
                    .text($.format.date(y[1], JS_DEFAULT_DATETIME_fmt_JS))
                    .addClass("oneline")
                    .appendTo(c);
                else if (T == x.length - 1)
                  (C = $("<tr></tr>").appendTo(E)),
                    (w = $(
                      "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
                    ).appendTo(C)),
                    $(
                      "<div style='height: 100px; width: 102%; overflow-y: scroll; background: #fff; '></div>"
                    )
                      .appendTo(w)
                      .text(y[1]);
                else
                  $(
                    "<td align='right' style='border-right: 15px solid #fff; border-left: 0px solid;'></td>"
                  )
                    .text(y[1])
                    .addClass("oneline")
                    .appendTo(c);
              }
            }
      $("#assetinfo #statuslist tbody tr:even").addClass("oddcolor"),
        $("#assetinfo #statuslist tbody").addClass("tab_status"),
        (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var D = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        L = $("<tr></tr>").appendTo(D),
        A = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_scmd")
          .text(JS_SHORTCUT_COMMAND)
          .appendTo(L);
      (L = $("<tr></tr>").appendTo(D)),
        (A = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 50px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(L)),
        initscmd(
          e,
          $(
            "<div style='height: 100px; width: 102%; overflow-y: scroll;'></div>"
          ).appendTo(A),
          i.properties.st
        );
      var F = $("#assetinfo #statuslist tr:eq(0)"),
        J =
          ((I = $(
            "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'; ></td>"
          ).appendTo(F)),
          $("<table style='margin: -3px 0px 0px 0px;'></table>")
            .addClass("tab_status")
            .appendTo(I)),
        N = $("<tr></tr>").appendTo(J),
        U = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_levent")
          .text(JS_RECENT_EVENTS)
          .appendTo(N);
      (N = $("<tr></tr>").appendTo(J)),
        (U = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(N));
      var M = $(
        "<div style='height: 100px; width: 102%; overflow-y: scroll;'></div>"
      ).appendTo(U);
      !o || a || queryingAlarm
        ? showLastAlarms(e, M, i)
        : (M.addClass("query_waiting"), getLastAlarms(e, M, i)),
        (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var O = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        P = $("<tr></tr>").appendTo(O),
        R = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lmileage")
          .text(JS_RECENT_MILEAGE + "(" + UNIT_DIST + ")")
          .appendTo(P);
      (P = $("<tr></tr>").appendTo(O)),
        (R = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(P));
      var B = $(
        "<div id='sta_last5day_mileage' style='min-width: 150px; min-height: 100px;'></div>"
      ).appendTo(R);
      (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var V = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        q = $("<tr></tr>").appendTo(V),
        j = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lengine")
          .text(JS_RECENT_ENGINE + "(h)")
          .appendTo(q);
      (q = $("<tr></tr>").appendTo(V)),
        (j = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(q));
      var G = $(
        "<div id='sta_last5day_engine' style='min-width: 150px; min-height: 100px;'></div>"
      ).appendTo(j);
      (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var z = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        W = $("<tr></tr>").appendTo(z),
        H = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lload")
          .text(JS_RECENT_LOAD + "(h)")
          .appendTo(W);
      (W = $("<tr></tr>").appendTo(z)),
        (H = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(W));
      var Z = $(
        "<div id='sta_last5day_load' style='min-width: 150px; min-height: 100px;'></div>"
      ).appendTo(H);
      !o || a || queryingMilEng
        ? createLast5daysMiEgBar(e, B, G, Z)
        : (B.addClass("query_waiting"),
          G.addClass("query_waiting"),
          Z.addClass("query_waiting"),
          getLast5daysMiEg(e, B, G, Z)),
        (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var K = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        Y = $("<tr></tr>").appendTo(K),
        Q = $(
          "<td style='padding-left: 25px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lspeed")
          .text(JS_RECENT_SPEEDOMETER + "(" + UNIT_SPEED + ")")
          .appendTo(Y);
      (Y = $("<tr></tr>").appendTo(K)),
        (Q = $(
          "<td bgcolor='#fff' class='speedometer' height='100px' rowspan='5' valign='top' style='background: #fff; width: 100px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(Y));
      $(
        "<canvas id='sta_speedometer' style='max-width: 200px; max-height: 100%; margin-left: -40px; margin-right: -50px; margin-bottom: 0px;'></canvas><label style='display:block; margin-left:35px; margin-top:-60px;'><span style='font-weight:bold; font-size: 20px'>" +
          i.properties.s +
          "</span>" +
          UNIT_SPEED +
          "</label>"
      ).appendTo(Q);
      createSpeedometer(i.properties.s),
        (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var X = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        ee = $("<tr></tr>").appendTo(X),
        te = $(
          "<td style='padding-left: 25px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_tiresensor")
          .text(JS_RECENT_TIRESENSOR)
          .appendTo(ee);
      (ee = $("<tr></tr>").appendTo(X)),
        (te = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 100px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(ee));
      var oe = $(
          "<div id='sta_tiresensor' style='min-height: 100px;'></div>"
        ).appendTo(te),
        ae = parseTireData(getIdValue("51:", i.properties.io, !0));
      if (0 == ae.index.length) {
        var se = $(
          "<label nowrap='nowrap' style='padding: 2px; height: 60px; width: 100%; font-size:15pt; color: #AAAAAA; line-height: 70px;'></label>"
        ).text(JS_NO_DATA);
        $("#sta_tiresensor").append(se),
          oe.css({ "min-width": "100px", "text-align": "center" });
      } else
        oe.css("min-width", 150 + 50 * ae.index.length + "px"),
          createTiresensorBar(ae.index, ae.tire, ae.temp, ae.bat);
      (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var de = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        le = $("<tr></tr>").appendTo(de);
      $(
        "<td colspan='2' style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
      )
        .addClass("info_ldriver")
        .text(JS_RECENT_DRIVER)
        .appendTo(le);
      le = $(
        "<tr style='border-left: 0px solid; border-right: 0px solid;'></tr>"
      ).appendTo(de);
      $(
        "<td id='sta_last_driver_info' bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 100px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
      ).appendTo(le);
      var ie = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 100px; border-left: 0px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(le),
        re = $(
          "<div id='sta_last_driver_img' style='min-width: 100px; min-height: 100px;'><ul><li><img src='img/none driver.png' alt='null' height='89' width='80'></li></ul></div>"
        ).appendTo(ie);
      !o || a || queryingDriver
        ? showLastDriver(e)
        : (re.addClass("query_waiting"), getLastDriver(e, i.properties.jb, re));
      (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'; ></td>"
        ).appendTo(F));
      var pe = $("<table style='margin: -3px 0px 0px 0px;'></table>")
          .addClass("tab_status")
          .appendTo(I),
        ne = $("<tr></tr>").appendTo(pe),
        ce = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lmaintain")
          .text(JS_RECENT_MAINTAINANCE)
          .appendTo(ne);
      (ne = $("<tr></tr>").appendTo(pe)),
        (ce = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 100px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(ne));
      var _e = $(
          "<div style='height: 100px; width: 102%; overflow-y: scroll;'></div>"
        ).appendTo(ce),
        me =
          ((F = $("#assetinfo #statuslist tr:eq(0)")),
          (I = $(
            "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'; ></td>"
          ).appendTo(F)),
          $("<table style='margin: -3px 0px 0px 0px;'></table>")
            .addClass("tab_status")
            .appendTo(I)),
        fe = $("<tr></tr>").appendTo(me),
        be = $(
          "<td style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_ltask")
          .text(JS_RECENT_TASK)
          .appendTo(fe);
      (fe = $("<tr></tr>").appendTo(me)),
        (be = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 100px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(fe));
      var ge,
        he = $(
          "<div style='height: 100px; width: 102%; overflow-y: scroll;'></div>"
        ).appendTo(be),
        ue = 0,
        xe = getIdValue("A:", i.properties.io);
      null != xe && (ue = mileageUnitConversion(xe, JS_UNIT_DISTANCE)),
        (ge = getIdValue("11:", i.properties.io)),
        !o || a || queryingMaTa
          ? showLastMaTa(e, _e, he, ue, ge)
          : (he.addClass("query_waiting"),
            _e.addClass("query_waiting"),
            getLastMaTa(e, _e, he, ue, ge)),
        (F = $("#assetinfo #statuslist tr:eq(0)")),
        (I = $(
          "<td rowspan='6' valign='top' style='border-left: 10px solid #fff; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;' bgcolor='#fff'></td>"
        ).appendTo(F));
      var $e = $("<table style='margin: -3px 0px 0px 0px'></table>")
          .addClass("tab_status")
          .appendTo(I),
        ve = $("<tr></tr>").appendTo($e),
        Te = $(
          "<td id='sta_last_photo_title' style='padding-left: 20px; white-space: nowrap; border-top: 0px solid; border-left: 5px solid #F5F5F5;'></td>"
        )
          .addClass("info_lphoto")
          .text(JS_LAST_PHOTO)
          .appendTo(ve);
      (ve = $("<tr></tr>").appendTo($e)),
        (Te = $(
          "<td bgcolor='#fff' height='100px' rowspan='5' valign='top' style='background: #fff; min-width: 150px; border-left: 5px solid #F5F5F5; border-top: 0px solid; border-right: 0px solid; border-bottom: 0px solid;'></td>"
        ).appendTo(ve));
      var ye = $(
        "<div id='sta_last_photo' style='min-width: 150px; min-height: 100px; text-align: center; overflow-y: hidden;'></div>"
      ).appendTo(Te);
      !o || a || queryingPhoto
        ? displayLastPhoto(e, ye)
        : (ye.addClass("query_waiting"), getLastPhoto(e, ye)),
        $("#assetinfo").animate({ scrollLeft: -r }, 0);
    }
    void 0 !== a &&
      a &&
      map.AddTrackPoint(
        e,
        i.properties.x,
        i.properties.y,
        i.properties.s,
        i.properties.t,
        i.properties.dir,
        null,
        ANIMATION_TIME
      ),
      map.MoveTop(i);
  }
}
function parseTireData(e) {
  var t = { index: [], tire: [], temp: [], bat: [] };
  if (null != e && e.length > 0) {
    var o = e.split("&");
    if (o.length > 0)
      for (var a = 0; a < o.length; a++)
        if (null != o[a] && o[a].length > 0) {
          var s = o[a].split("*");
          null != s &&
            4 == s.length &&
            (t.index.push(parseInt(s[0])),
            t.tire.push(
              0 == s[1].length
                ? 0
                : tpmsUnitConversion(parseFloat(s[1]), JS_UNIT_TPMS)
            ),
            t.temp.push(
              0 == s[2].length
                ? 0
                : tempUnitConversion(parseFloat(s[2]), JS_UNIT_TEMPERATURE)
            ),
            t.bat.push(
              0 == s[3].length ? 0 : parseFloat(parseFloat(s[3]).toFixed(0))
            ));
        }
  }
  return t;
}
function initscmd(e, t, o) {
  if (null != typeCmd && 0 != typeCmd.length) {
    getTypeById(e);
    var a = $("<table></table>").appendTo(t),
      s = $("<tr></tr>").appendTo(a),
      d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s);
    $("<label>" + JS_CMD_ENABLE_IMMOBILIZER + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var l = $(
      "<input type='checkbox' id='scmd_cut' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_cut'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_cut").click(function () {
        $("#scmd_cut").prop("checked") && sendScommand(e, 6, null, l);
      }),
      null != o &&
        -1 != o.indexOf("301D") &&
        $("#scmd_cut").prop("checked", !0);
    (s = $("<tr></tr>").appendTo(a)),
      (d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    $("<label>" + JS_CMD_DISABLE_IMMOBILIZER + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var i = $(
      "<input type='checkbox' id='scmd_uncut' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_uncut'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_uncut").click(function () {
        $("#scmd_uncut").prop("checked") && sendScommand(e, 7, null, i);
      });
    (s = $("<tr></tr>").appendTo(a)),
      (d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    $("<label>" + JS_CMD_ARM + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var r = $(
      "<input type='checkbox' id='scmd_arm' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_arm'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_arm").click(function () {
        $("#scmd_arm").prop("checked") && sendScommand(e, 653, null, r);
      }),
      null != o &&
        -1 != o.indexOf("3007") &&
        $("#scmd_arm").prop("checked", !0);
    (s = $("<tr></tr>").appendTo(a)),
      (d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    $("<label>" + JS_CMD_DISARM + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var p = $(
      "<input type='checkbox' id='scmd_disarm' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_disarm'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_disarm").click(function () {
        $("#scmd_disarm").prop("checked") && sendScommand(e, 665, null, p);
      }),
      null != o &&
        -1 != o.indexOf("3008") &&
        $("#scmd_disarm").prop("checked", !0);
    (s = $("<tr></tr>").appendTo(a)),
      (d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    $("<label>" + JS_CMD_LOCK_DOOR + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var n = $(
      "<input type='checkbox' id='scmd_lock' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_lock'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_lock").click(function () {
        $("#scmd_lock").prop("checked") && sendScommand(e, 4, null, n);
      }),
      null != o &&
        -1 != o.indexOf("3002") &&
        $("#scmd_lock").prop("checked", !0);
    (s = $("<tr></tr>").appendTo(a)),
      (d = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    $("<label>" + JS_CMD_UNLOCK_DOOR + "</label>").appendTo(d),
      ($td_scmd_btn = $(
        "<td class='scmd' nowrap='nowrap' style='border-left: 0px solid; border-right: 0px solid; border-top: 0px solid;  border-bottom: 1px solid #EEE; padding: 2px;'></td>"
      ).appendTo(s));
    var c = $(
      "<input type='checkbox' id='scmd_unlock' class='cmdcheckbox'></input>"
    ).appendTo($td_scmd_btn);
    $("<label class='cmdswitch' for='scmd_unlock'></label>").appendTo(
      $td_scmd_btn
    ),
      $("#scmd_unlock").click(function () {
        $("#scmd_unlock").prop("checked") && sendScommand(e, 5, null, c);
      }),
      null != o &&
        -1 != o.indexOf("3001") &&
        $("#scmd_unlock").prop("checked", !0);
  }
}
function issupportcmd(e, t) {
  var o = !1;
  if (null != typeCmd)
    for (var a = 0; a < typeCmd.length; a++)
      if (typeCmd[a].tid == e && (typeCmd[a], t == typeCmd[a].cid)) {
        o = !0;
        break;
      }
  return o;
}
function sendScommand(e, t, o, a) {
  var s = {
    objid: e,
    cmdid: t,
    params: null == o ? "" : o.substring(0, o.length - 1),
  };
  try {
    $.get("command.ajax.php", s, function (e) {
      e.indexOf("ok") >= 0 || a.prop("checked", !1);
    });
  } catch (e) {
    a.prop("checked", !1);
  }
}
function link_marker(e) {
  try {
    void 0 !== map && map.LinkMarker(e);
  } catch (e) {}
}
function findpageitem(e, t) {
  var o,
    a = !1,
    s = 0;
  if (
    ("1" == $("#asset_list_item").val()
      ? (o = $(e + " .tree_table").find("tbody tr[c='" + t + "']"))
      : "2" == $("#asset_list_item").val()
      ? (o = $(e + " .tree_table").find("tbody tr[nc='" + t + "']"))
      : "3" == $("#asset_list_item").val()
      ? (o = $(e + " .tree_table").find("tbody tr[si='" + t + "']"))
      : "4" == $("#asset_list_item").val()
      ? (o = $(e + " .tree_table").find("tbody tr[dn='" + t + "']"))
      : ((s = 1), (o = $(e + " .tree_table").find("tbody tr[t*='" + t + "']"))),
    o.length > 0)
  ) {
    var d = o.eq(0);
    $lastselect &&
      (0 == s
        ? ($lastselect.removeClass("active"),
          $lastselect.next().removeClass("active"))
        : $lastselect.removeClass("gractive")),
      0 == s
        ? (d.addClass("active"), d.next().addClass("active"))
        : d.addClass("gractive"),
      ($lastselect = d);
    var l = d.parent().find("tr th:eq(2)"),
      i = parseInt(d.attr("n"));
    if (l.hasClass("close")) {
      l.removeClass("close").addClass("open");
      var r = l.parent().parent().parent().attr("id"),
        p = l.parent().parent().find("tr:gt(0):not(.end_state)");
      $.each(p, function (e, t) {
        var o = parseInt($(t).attr("n"));
        updateOne(GroupItem[r + "_" + o]);
      }),
        d.parent().find("tr:gt(0)").toggle();
    }
    (current_id = i),
      map_locate(i, !0, !0, !1, !1),
      0 != d.position().top &&
        ($(e).parent().scrollTop(0), $(e).parent().scrollTop(d.position().top)),
      (a = !0);
  }
  return a;
}
function findpageitems(e) {
  var t = [],
    o = $(".tab_active").attr("target");
  if ("#tab_all" == o)
    (a = $("#tab_online .tree_table").find("tbody tr[n=" + e + "]")).length >
      0 && t.push(a),
      (a = $("#tab_offline .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a),
      (a = $("#tab_expired .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a);
  else if ("#tab_online" == o) {
    (a = $("#tab_all .tree_table").find("tbody tr[n=" + e + "]")).length > 0 &&
      t.push(a),
      (a = $("#tab_offline .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a),
      (a = $("#tab_expired .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a);
  } else if ("#tab_offline" == o) {
    (a = $("#tab_all .tree_table").find("tbody tr[n=" + e + "]")).length > 0 &&
      t.push(a),
      (a = $("#tab_online .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a),
      (a = $("#tab_expired .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a);
  } else if ("#tab_expired" == o) {
    var a;
    (a = $("#tab_all .tree_table").find("tbody tr[n=" + e + "]")).length > 0 &&
      t.push(a),
      (a = $("#tab_online .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a),
      (a = $("#tab_offline .tree_table").find("tbody tr[n=" + e + "]")).length >
        0 && t.push(a);
  }
  return t;
}
function search_select() {
  releaseTrack();
  var e = $("#sch #device").val();
  if ("" != e) {
    var t = $(".tab_active").attr("target");
    findpageitem(t, e) ||
      "#tab_all" == t ||
      (pagechanged("#tab_all"), findpageitem("#tab_all", e));
  }
}
function relocate() {
  if (!nologin) {
    if ((remain--, remain < 0)) {
      remain = JS_GLOBAL_MIM_UPDATE;
      var objid = getShowObjs();
      objid.length >= 0 &&
        $.post(
          "devstat.ajax.php?t=" + new Date().getTime(),
          { objid: objid },
          function (data) {
            if ("" != data) {
              try {
                if ("nologin" == data)
                  timer &&
                    (clearTimeout(timer),
                    (timer = null),
                    (nologin = !0),
                    (window.location.href = "../login.php"));
                else {
                  needloc = !1;
                  var result = eval("(" + data + ")");
                  refresh_list(result),
                    updateDevice(result.data, current_id, map, result.first),
                    "block" == $("#dlg_objstatechart").css("display") &&
                      showObjChart(),
                    checkTabbarScrollbar();
                }
              } catch (e) {
                alert(e.message);
              }
              data = null;
            }
          }
        ),
        needUpdatePlace && loadPlace(),
        needLoadCommand && loadUserCommand(),
        needUpdateUser && loadUser();
    }
    var $timeout = $("#geo #timeout");
    $timeout.text(remain).attr("title", JS_LOCATE_TIP.replace("%d", remain)),
      ($timeout = null),
      (timer = null),
      (timer = setTimeout("relocate()", 1e3));
  }
}
function onfree() {
  if (
    ((JS_DEVICE_ID4FLAG = null),
    (JS_DEVICE_FLAG4ID = null),
    (JS_DEVICE_STATUS = null),
    (JS_DEVICE_TYPE4ID = null),
    (JS_GROUP = null),
    (JS_DEVICE_NO4ID = null),
    (JS_DEVICE_SIM4ID = null),
    (JSDEVICE_DRIVER4ID = null),
    void 0 !== map)
  )
    try {
      map.Free(), (map = null);
    } catch (e) {}
}
function oninit() {}
function onLoadGoogle() {
  1 == JS_GOOGLE_TYPE
    ? loadScript(
        "https://maps.googleapis.com/maps/api/js?key=" + JS_GOOGLE_KEY,
        onLoadGoogleMutant()
      )
    : onLoadGoogleMutant();
}
function onLoadGoogleMutant() {
  loadScript("map/leaflet/Leaflet.GoogleMutant.js", onLoadMap);
}
function onLoadMap() {
  var e = {
    centerLng: JS_DEFAULT_LNG,
    centerLat: JS_DEFAULT_LAT,
    zoom: JS_DEFAULT_ZOOM,
  };
  if (
    ((map = new MapOperat("map", e, !0, !0, !1)),
    (ext = new MapExtend(map.GetMap(), !1, !1)),
    0 == JS_GOOGLE_TYPE && blockMoroccoBorders)
  ) {
    for (
      var t = [],
        o = "27.667269,-13.173926;27.667269,-8.667617".split(";"),
        a = 0;
      a < o.length;
      a++
    ) {
      var s = [o[a].split(",")[0], o[a].split(",")[1]];
      t.push(s);
    }
    ext.BuildPolyline(t, !1, "#F3F1ED", 20, !1, "", 15),
      (o = "24.226929,-16.260254;25.145285,-10.128906".split(";")),
      ext.BuildRectangle(
        parseFloat(o[0].split(",")[0]),
        parseFloat(o[0].split(",")[1]),
        parseFloat(o[1].split(",")[0]),
        parseFloat(o[1].split(",")[1]),
        !1,
        "#F3F1ED",
        20,
        !1,
        "",
        8,
        1
      );
  }
  loadPlace(),
    loadUserCommand(),
    loadUser(),
    map.Zoom(JS_DEFAULT_ZOOM),
    $("#maptools #ed_asset").attr("title", JS_ENABLE_DISABLE_ASSET),
    $("#maptools #ed_fit").attr("title", JS_FIT_ASSETS),
    1 == JS_DEFAULT_SHOW &&
      $("#maptools #ed_asset").css({ opacity: 1 }).addClass("tool_active"),
    $("#maptools #ed_label").attr("title", JS_ENABLE_DISABLE_LABEL),
    $("#maptools #ed_marker").attr("title", JS_ENABLE_DISABLE_MARKER),
    1 == JS_DEFAULT_MARKER &&
      $("#maptools #ed_marker").css({ opacity: 1 }).addClass("tool_active"),
    $("#maptools #ed_zone").attr("title", JS_ENABLE_DISABLE_ZONES),
    1 == JS_DEFAULT_ZONE &&
      $("#maptools #ed_zone").css({ opacity: 1 }).addClass("tool_active"),
    $("#maptools #ed_clusters").attr("title", JS_ENABLE_DISABLE_CLUSTERS),
    $("#maptools #ed_measure").attr("title", JS_ENABLE_DISABLE_MEASURE),
    $("#maptools #ed_ruler").attr("title", JS_ENABLE_DISABLE_RULER),
    $("#maptools #ed_navigation").attr("title", JS_ENABLE_DISABLE_NAVIGATION),
    $("#maptools #ed_street_view").attr("title", JS_ENABLE_DISABLE_STREETVIEW),
    $("#maptools #ed_task").attr("title", JS_DISABLE_TASK),
    $("#maptools #ed_driver").attr("title", JS_ENABLE_DISABLE_DRIVER),
    $("#maptools #ed_asset")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_asset").hasClass("tool_active")
          ? ($("#maptools #ed_asset").removeClass("tool_active"),
            $("#maptools #ed_asset").css({ opacity: 0.5 }),
            showAllObj(!1),
            cancelDefShowAll())
          : ($("#maptools #ed_asset").addClass("tool_active"),
            $("#maptools #ed_asset").css({ opacity: 1 }),
            showAllObj(!0));
      }),
    $("#maptools #ed_fit")
      .parent()
      .unbind("click")
      .click(function () {
        map.MarkersFitBounds();
      }),
    $("#maptools #ed_label")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_label").hasClass("tool_active")
          ? ($("#maptools #ed_label").removeClass("tool_active"),
            $("#maptools #ed_label").css({ opacity: 0.5 }),
            map.ToggleMarkerTooltip(!1))
          : ($("#maptools #ed_label").addClass("tool_active"),
            $("#maptools #ed_label").css({ opacity: 1 }),
            map.ToggleMarkerTooltip(!0));
      }),
    $("#maptools #ed_marker")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_marker").hasClass("tool_active")
          ? ($("#maptools #ed_marker").removeClass("tool_active"),
            $("#maptools #ed_marker").css({ opacity: 0.5 }),
            ext.ClearUserMarker(usermarkers))
          : ($("#maptools #ed_marker").addClass("tool_active"),
            $("#maptools #ed_marker").css({ opacity: 1 }),
            drawUserMarker());
      }),
    $("#maptools #ed_zone")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_zone").hasClass("tool_active")
          ? ($("#maptools #ed_zone").removeClass("tool_active"),
            $("#maptools #ed_zone").css({ opacity: 0.5 }),
            ext.ClearZone(zones))
          : ($("#maptools #ed_zone").addClass("tool_active"),
            $("#maptools #ed_zone").css({ opacity: 1 }),
            drawZone());
      }),
    $("#maptools #ed_clusters")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_clusters").hasClass("tool_active")
          ? ($("#maptools #ed_clusters").removeClass("tool_active"),
            $("#maptools #ed_clusters").css({ opacity: 0.5 }),
            map.ClustersMarker(!1))
          : ($("#maptools #ed_clusters").addClass("tool_active"),
            $("#maptools #ed_clusters").css({ opacity: 1 }),
            map.ClustersMarker(!0));
      }),
    $("#maptools #ed_measure")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_measure").hasClass("tool_active")
          ? ($("#maptools #ed_measure").removeClass("tool_active"),
            $("#maptools #ed_measure").css({ opacity: 0.5 }),
            map.ActiveMeasureTool(!1))
          : ($("#maptools #ed_measure").addClass("tool_active"),
            $("#maptools #ed_measure").css({ opacity: 1 }),
            map.ActiveMeasureTool(!0),
            $("#maptools #ed_ruler").removeClass("tool_active"),
            $("#maptools #ed_ruler").css({ opacity: 0.5 }),
            map.ActiveRulerTool(!1),
            $("#maptools #ed_navigation").removeClass("tool_active"),
            $("#maptools #ed_navigation").css({ opacity: 0.5 }),
            map.ActiveNavigationTool(!1));
      }),
    $("#maptools #ed_ruler")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_ruler").hasClass("tool_active")
          ? ($("#maptools #ed_ruler").removeClass("tool_active"),
            $("#maptools #ed_ruler").css({ opacity: 0.5 }),
            map.ActiveRulerTool(!1))
          : ($("#maptools #ed_ruler").addClass("tool_active"),
            $("#maptools #ed_ruler").css({ opacity: 1 }),
            map.ActiveRulerTool(!0),
            $("#maptools #ed_measure").removeClass("tool_active"),
            $("#maptools #ed_measure").css({ opacity: 0.5 }),
            map.ActiveMeasureTool(!1),
            $("#maptools #ed_navigation").removeClass("tool_active"),
            $("#maptools #ed_navigation").css({ opacity: 0.5 }),
            map.ActiveNavigationTool(!1));
      }),
    $("#maptools #ed_navigation")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_navigation").hasClass("tool_active")
          ? ($("#maptools #ed_navigation").removeClass("tool_active"),
            $("#maptools #ed_navigation").css({ opacity: 0.5 }),
            map.ActiveNavigationTool(!1))
          : ($("#maptools #ed_navigation").addClass("tool_active"),
            $("#maptools #ed_navigation").css({ opacity: 1 }),
            $("#maptools #ed_ruler").removeClass("tool_active"),
            $("#maptools #ed_ruler").css({ opacity: 0.5 }),
            map.ActiveRulerTool(!1),
            $("#maptools #ed_measure").removeClass("tool_active"),
            $("#maptools #ed_measure").css({ opacity: 0.5 }),
            map.ActiveMeasureTool(!1),
            map.ActiveNavigationTool(!0));
      }),
    $("#maptools #ed_street_view")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_street_view").hasClass("tool_active")
          ? ($("#maptools #ed_street_view").removeClass("tool_active"),
            $("#maptools #ed_street_view").css({ opacity: 0.5 }),
            $("#streetview_img").css("display", "none"),
            $("#maptools #ed_street_view")
              .removeAttr("x")
              .removeAttr("y")
              .removeAttr("dir"))
          : ($("#maptools #ed_street_view").addClass("tool_active"),
            $("#maptools #ed_street_view").css({ opacity: 1 }),
            $("#streetview_img").css({
              display: "-webkit-box",
              "-webkit-box-align": "center",
              "-webkit-box-pack": "center",
            }),
            current_id > 0 && map_locate(current_id, !0, !0, !1, !0));
      }),
    $("#maptools #ed_driver")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_driver").hasClass("tool_active")
          ? ($("#maptools #ed_driver").removeClass("tool_active"),
            $("#maptools #ed_driver").css({ opacity: 0.5 }),
            map.ToggleDriver(!1))
          : ($("#maptools #ed_driver").addClass("tool_active"),
            $("#maptools #ed_driver").css({ opacity: 1 }),
            map.ToggleDriver(!0));
      }),
    $("#maptools #ed_task")
      .parent()
      .unbind("click")
      .click(function () {
        $("#maptools #ed_task").hasClass("tool_active") && disableCurrentTask();
      }),
    $("#streetview_img")
      .unbind("click")
      .click(function () {
        var e = $("#maptools #ed_street_view").attr("x"),
          t = $("#maptools #ed_street_view").attr("y"),
          o = $("#maptools #ed_street_view").attr("dir");
        openStreetView(e, t, o);
      }),
    $("#asset_list_item").change(function () {
      if ("1" == $("#asset_list_item").val()) {
        var e = getDeviceList();
        $("#device").attr("placeholder", JS_ASSET_NAME),
          $("#device")
            .focus(function () {
              $(this).autocomplete("search", $(this).val());
            })
            .autocomplete({
              source: e,
              minLength: e.length < 2e3 ? 0 : 2,
              max: 10,
              scroll: !0,
              delay: 0,
            });
      } else if ("2" == $("#asset_list_item").val()) {
        e = getIDsList();
        $("#device").attr("placeholder", JS_DEVICE_ID),
          $("#device")
            .focus(function () {
              $(this).autocomplete("search", $(this).val());
            })
            .autocomplete({
              source: e,
              minLength: e.length < 2e3 ? 0 : 2,
              max: 10,
              scroll: !0,
              delay: 0,
            });
      } else if ("3" == $("#asset_list_item").val()) {
        e = getSimList();
        $("#device").attr("placeholder", JS_SIMCARD_NO),
          $("#device")
            .focus(function () {
              $(this).autocomplete("search", $(this).val());
            })
            .autocomplete({
              source: e,
              minLength: e.length < 2e3 ? 0 : 2,
              max: 10,
              scroll: !0,
              delay: 0,
            });
      } else if ("4" == $("#asset_list_item").val()) {
        e = getDriverList();
        $("#device").attr("placeholder", JS_DRIVER_NAME),
          $("#device")
            .focus(function () {
              $(this).autocomplete("search", $(this).val());
            })
            .autocomplete({
              source: e,
              minLength: e.length < 2e3 ? 0 : 2,
              max: 10,
              scroll: !0,
              delay: 0,
            });
      } else {
        e = getGroupList();
        $("#device").attr("placeholder", JS_GROUP_NAME),
          $("#device")
            .focus(function () {
              $(this).autocomplete("search", $(this).val());
            })
            .autocomplete({
              source: e,
              minLength: e.length < 2e3 ? 0 : 2,
              max: 10,
              scroll: !0,
              delay: 0,
            });
      }
    }),
    $("#share_position_search").click(function () {
      var e = $("#mgrshare_position_item").val(),
        t = $("#mgrshare_position_cond").val();
      "" != t && "1" == e && locate_table("#share_position_list", "sn", t, !0);
    });
}
function loadUserCommand() {
  $.get("commandinfo.ajax.php", function (data) {
    if ("" != $.trim(data)) {
      var result = eval("(" + data + ")");
      null != result &&
        void 0 !== result &&
        ((typeCmd = result.tcmd), (protocolCmd = result.pparam));
    }
    needLoadCommand = !1;
  });
}
function loadPlace() {
  $.post("manage.ajax.php", { type: 6, full: 1 }, function (data) {
    if ("" != $.trim(data)) {
      var result = eval("(" + data + ")");
      if (null != result && void 0 !== result)
        if (null != result.list) {
          (needUpdatePlace = !1), (geoList = result.list);
          for (var a = 0; a < geoList.length; a++) {
            var o = geoList[a];
            (JS_PLACE_NAME4ID[o.zid] = o.an), (JS_PLACE_ID4NAME[o.an] = o);
          }
          $("#maptools #ed_zone").hasClass("tool_active") &&
            (ext.ClearZone(zones), drawZone()),
            $("#maptools #ed_marker").hasClass("tool_active") &&
              (ext.ClearUserMarker(usermarkers), drawUserMarker());
        } else ext.ClearZone(zones), ext.ClearUserMarker(usermarkers);
    }
  });
}
function loadUser() {
  $.post("manage.ajax.php", { type: 1 }, function (data) {
    if ("" != $.trim(data)) {
      var result = eval("(" + data + ")");
      if (null != result && void 0 !== result && null != result.list) {
        var jo,
          list = result.list;
        (needUpdateUser = !1), (array_users = []);
        for (var i = 0; i < list.length; i++)
          (jo = list[i]), array_users.push(jo.uname);
      }
    }
  });
}
function drawZone() {
  var e;
  if (null != geoList && "undefined" != geoList && 0 != geoList.length)
    for (var t = 0; t < geoList.length; t++) {
      var o = geoList[t],
        a = $.trim(o.ac),
        s = o.zoom;
      if (1 == o.at) {
        var d = o.ap.split(",");
        (e = ext.BuildCircle(
          parseFloat(d[0]),
          parseFloat(d[1]),
          parseFloat(d[2]),
          !1,
          a,
          s,
          !1,
          o.an
        )),
          (zones[o.zid] = e);
      } else if (2 == o.at) {
        var l = o.ap.split(";");
        (e = ext.BuildRectangle(
          parseFloat(l[0].split(",")[0]),
          parseFloat(l[0].split(",")[1]),
          parseFloat(l[1].split(",")[0]),
          parseFloat(l[1].split(",")[1]),
          !1,
          a,
          s,
          !1,
          o.an
        )),
          (zones[o.zid] = e);
      } else if (3 == o.at) {
        for (var i = [], r = ((l = o.ap.split(";")), 0); r < l.length; r++) {
          var p = [l[r].split(",")[0], l[r].split(",")[1]];
          i.push(p);
        }
        (e = ext.BuildPolygon(i, !1, a, s, !1, o.an)), (zones[o.zid] = e);
      } else if (5 == o.at) {
        for (i = [], l = o.ap.split(";"), r = 0; r < l.length; r++) {
          p = [l[r].split(",")[0], l[r].split(",")[1]];
          i.push(p);
        }
        (e = ext.BuildPolyline(i, !1, a, s, !1, o.an)), (zones[o.zid] = e);
      }
    }
}
function drawUserMarker() {
  var e;
  if (null != geoList && "undefined" != geoList && 0 != geoList.length)
    for (var t = 0; t < geoList.length; t++) {
      var o = geoList[t],
        a = $.trim(o.ac),
        s = o.zoom;
      if (4 == o.at) {
        var d = o.ap.split(",");
        (e = ext.BuildMarker(
          parseFloat(d[0]),
          parseFloat(d[1]),
          !1,
          a,
          s,
          !1,
          o.an
        )),
          (usermarkers[o.zid] = e);
      }
    }
}
function showView(e, t) {
  var o = $(e);
  t
    ? (o.css("visibility", "visible"), o.css("z-index", "1"))
    : (o.css("visibility", "hidden"), o.css("z-index", "-1"));
}
function showPage(e, t) {
  if ("nav_current" != e.id) {
    (document.getElementById("nav_current").id = ""), (e.id = "nav_current");
    var o = "";
    switch (t) {
      case "monitor":
        showView("#frm", !1),
          showView(
            "#sch, #mod, #tip, #map, #geo, #speedcompass, #streetview_img, #maptools, #assetinfo, #stasep",
            !0
          ),
          $("#speedcompass .content *").attr("visibility", "visible");
        break;
      case "playback":
        o = "playback.view.php";
        break;
      case "stastics":
        o = "stastics.view.php";
        break;
      case "manage":
        o = "manage.view.php";
        break;
      case "setting":
        o = "setting.view.php";
    }
    if ("" != o) {
      showView("#frm", !0),
        showView(
          "#sch, #mod, #tip, #map, #geo, #speedcompass, #streetview_img, #maptools, #assetinfo, #stasep",
          !1
        ),
        $("#speedcompass .content *").attr("visibility", "hidden");
      var a = document.getElementById("frame_content");
      (a.src.indexOf(o) < 0 ||
        ("playback.view.php" == o && null != this.fastHistoryValue)) &&
        ((a.height = document.body.clientHeight - OffsetH),
        (a.width = document.body.clientWidth - OffsetW),
        (a.src = o));
    }
  }
}
function showFastHistory(e) {
  $("#mnuOperat").hide(),
    (this.fastHistoryValue = e),
    showPage(document.getElementsByClassName("playback")[0], "playback");
}
function showUseInfo() {
  showLoading(!0);
  var timer = setTimeout("showLoading(false,true)", requestTimeout);
  $.post("manage.ajax.php", { type: 1, usrid: -1, view: 1 }, function (data) {
    clearTimeout(timer), showLoading(!1);
    try {
      var json = eval("(" + data + ")"),
        jo = json[0],
        Wnd = $("#dlg_useinfo");
      $(Wnd).css("display", "block"),
        $("body").append("<div class='modalmask'></div>"),
        $(Wnd).append("<span id='close' class='dialog_cancel'></span>"),
        $(Wnd)
          .find("#close")
          .click(function () {
            $(Wnd).css("display", "none"),
              $(this).remove(),
              $(".modalmask").remove();
          }),
        $(Wnd)
          .find("#button_cancel")
          .click(function () {
            $(Wnd).css("display", "none"),
              $(Wnd).find("#close").remove(),
              $(".modalmask").remove();
          }),
        $(Wnd).css(
          "top",
          Math.round(
            document.body.clientHeight / 2 - ($(Wnd).height() / 3) * 2
          ) + "px"
        ),
        $(Wnd).css(
          "left",
          Math.round(document.body.clientWidth / 2 - $(Wnd).width() / 2) + "px"
        ),
        $(Wnd).find("#username").val(jo.uname),
        $(Wnd).find("#loginname").val(jo.login),
        $(Wnd).find("#useremail").val(jo.email),
        $(Wnd)
          .find("#emailreport")
          .prop("checked", 1 == jo.rmail),
        $(Wnd).find("#emailoffset").val(jo.rtime),
        $(Wnd)
          .find("#available")
          .prop("checked", 1 == jo.valid),
        $(Wnd).find("#userphone").val(jo.uphone),
        $(Wnd).find("#limitcar").val(jo.olimit),
        $(Wnd)
          .find(".itext ,.icheck")
          .attr("disabled", "disabled")
          .removeClass("enablebox")
          .addClass("disablebox");
    } catch (e) {
      showLoading(!1);
    }
  });
}
$(document).ready(function () {
  (window.onresize = function () {
    var e = document.getElementById("frame_content");
    "" != e.src &&
      ((e.height = document.body.clientHeight - OffsetH),
      (e.width = document.body.clientWidth - OffsetW));
  }),
    $("#tab_online").toggle(),
    $("#tab_offline").toggle(),
    $("#tab_expired").toggle(),
    $("#loadmapwait").css("display", "block"),
    (remain = JS_GLOBAL_MIM_UPDATE),
    (needShowAllAsset = JS_DEFAULT_SHOW),
    $.contextMenu({
      selector: ".tablist .tab_content",
      callback: function (e, t) {
        releaseTrack();
      },
      items: { relTrack: { name: JS_RELEASE_TRACK } },
    }),
    initUnits(),
    onLoadGoogle(),
    checkTabbarScrollbar(),
    getDeviceListData(0),
    $("#staswitch").addClass("hide_status"),
    $("#staswitch")
      .unbind("click")
      .click(function () {
        $(this).hasClass("hide_status") || firstClick
          ? ($(this).removeClass("hide_status"),
            $(this).attr("src", "img/down-arrow.svg"),
            $("#stasep").css("bottom", "161px"),
            $("#assetinfo").css("display", "block"),
            $("#map").css("bottom", "165px"),
            $("#streetview_img").css("bottom", "168px"),
            map && map.ResizeMapContainer(),
            firstClick && (firstClick = !1))
          : ($(this).addClass("hide_status"),
            $(this).attr("src", "img/up-arrow.svg"),
            $("#stasep").css("bottom", "4px"),
            $("#assetinfo").css("display", "none"),
            $("#map").css("bottom", "8px"),
            $("#streetview_img").css("bottom", "10px"),
            map && map.ResizeMapContainer());
      }),
    $("#shareexpired").datetimepicker({
      dateFormat: "yy-mm-dd",
      timeFormat: "HH:mm:ss",
      changeMonth: !0,
      changeYear: !0,
      yearRange: "-20:+20",
    }),
    $("#shareexpired")
      .unbind("click")
      .click(function () {
        $("#shareexpired").focus();
      }),
    "undefined" != typeof JS_P_UID && null != JS_P_UID && JS_P_UID.length > 0
      ? ($("#return_line").css("display", "block"),
        $("#user_return").css("display", "block"))
      : ($("#return_line").css("display", "none"),
        $("#user_return").css("display", "none")),
    $("#race_details tr:eq(0) th:eq(2)").append("(" + UNIT_DIST + ")"),
    $("#race_details tr:eq(0) th:eq(3)").append("(" + UNIT_DIST + ")"),
    $("#race_details tr:eq(0) th:eq(5)").append("(" + UNIT_DIST + ")"),
    $("#race_details tr:eq(0) th:eq(4)").append("(" + UNIT_SPEED + ")"),
    $("#race_details th")
      .unbind("click")
      .click(function () {
        (exportFileName = JS_RACE_INFO + "-" + getCurentDateTime()),
          (exportTableId = "race_details"),
          doExport(3);
      }),
    (iconSelect = new IconSelect("my-icon-select", {
      selectedIconWidth: 24,
      selectedIconHeight: 24,
      selectedBoxPadding: 1,
      iconsWidth: 24,
      iconsHeight: 24,
      boxIconSpace: 1,
      vectoralIconNumber: 4,
      horizontalIconNumber: 4,
    })).refresh(getIcons());
});
